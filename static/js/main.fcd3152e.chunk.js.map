{"version":3,"sources":["components/Form.module.css","components/Form.js","components/PaymentModal.js","components/AnalysisSection.js","api.js","App.js","reportWebVitals.js","index.js"],"names":["module","exports","Form","_ref","onSubmit","formData","setFormData","useState","name","gender","calendarType","year","month","day","hour","minute","province","city","years","Array","from","length","_","i","days","hours","toString","padStart","minutes","provinces","citydata","filter","item","pid","cities","filteredCities","selectedProvince","find","prov","id","_jsxs","e","preventDefault","alert","genders","solarDate","lunarMonth","isLeap","leapMonth","startsWith","lunarDate","window","p","Lunar2Solar","yi","mi","dz","selectedCity","c","J","j","W","w","eightCharacter","raw","txt","sz","join","xb","x","a","transformUserData","fatemaps","parseInt","className","styles","formContainer","children","_jsx","formRow","inputGroup","type","placeholder","underlineInput","value","onChange","target","buttonGroup","map","choiceButton","active","onClick","formRow1","dateSelectGroup","dateSelect","index","timeSelectGroup","formRow3","style","marginRight","disabled","submitButton","PaymentModal","isOpen","qrcodeUrl","onClose","countdown","setCountdown","useEffect","timer","setInterval","prev","Math","max","clearInterval","_Fragment","QRCodeSVG","size","fgColor","level","seconds","floor","ANALYSIS_TYPES","icon","color","SkeletonLoader","width","AnalysisSection","preview","unlocked","contents","onUnlock","isAnyUnlocked","some","cardRefs","useRef","sharedUrl","location","href","lastUnlockedType","findLast","current","scrollIntoView","behavior","block","handleShare","navigator","share","title","text","url","clipboard","writeText","Reactmarkdown","ref","el","borderColor","maxHeight","backgroundColor","BASE_URL","App","currentOrderId","setCurrentOrderId","analysisData","setAnalysisData","health","career","wealth","marriage","paymentState","setPaymentState","show","processingType","loading","setLoading","error","setError","es","setES","close","src","alt","console","log","paymentES","initiatePayment","prevOrderId","analysisType","handlers","EventSource","addEventListener","_handlers$onPaymentQR","data","JSON","parse","onPaymentQR","call","orderId","_handlers$onPaymentst","onPaymentstatus","_handlers$onAnalysisC","onAnalysisChunk","content","_handlers$onAnalysisE","onAnalysisEnd","_handlers$onError3","onError","message","chunk","analysisTypes","async","newES","createOrderStream","eightCharacters","encodeURIComponent","onerror","err","_handlers$onError","_handlers$onStream","onStream","_handlers$onComplete","onComplete","_handlers$onError2","qrcode","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","createRoot","document","getElementById","render","React","StrictMode"],"mappings":"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","file":"static/js/main.fcd3152e.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"formContainer\":\"Form_formContainer__30bom\",\"formRow\":\"Form_formRow__3daMv\",\"formRow1\":\"Form_formRow1__XS48M\",\"formRow3\":\"Form_formRow3__3AhXh\",\"inputGroup\":\"Form_inputGroup__EaPaw\",\"underlineInput\":\"Form_underlineInput__1EWfm\",\"optional\":\"Form_optional__5hbdU\",\"buttonGroup\":\"Form_buttonGroup__7LocG\",\"choiceButton\":\"Form_choiceButton__MMaii\",\"active\":\"Form_active__TTwYc\",\"dateSelectGroup\":\"Form_dateSelectGroup__32CjE\",\"dateSelect\":\"Form_dateSelect__3YUVx\",\"timeSelectGroup\":\"Form_timeSelectGroup__3IR3b\",\"underlineSelect\":\"Form_underlineSelect__1jtox\",\"citySelect\":\"Form_citySelect__3SZdv\",\"submitButton\":\"Form_submitButton__1NJMU\"};","import React, { useState } from 'react';\r\nimport styles from './Form.module.css';\r\nimport citydata from \"./city.json\"\r\n\r\nconst Form = ({ onSubmit }) => {\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    gender: '男', // 设置默认值\r\n    calendarType: '公历', // 设置默认值\r\n    year: '1993',\r\n    month: '1',\r\n    day: '1',\r\n    hour: '00',\r\n    minute: '00',\r\n    province: '北京市',\r\n    city: '北京市'\r\n  });\r\n\r\n  // 生成年份选项（1900-2050）\r\n  const years = Array.from({length: 151}, (_, i) => 1900 + i);\r\n  // const months = Array.from({length: 12}, (_, i) => i + 1);\r\n  const days = Array.from({length: 31}, (_, i) => i + 1);\r\n  // 农历月份选项，包括可能的闰月\r\n  const updateMonthOptions = () => {\r\n    if (formData.calendarType === '农历') {\r\n      return [\r\n        '正月', '二月', '三月', '四月', '五月', '六月',\r\n        '七月', '八月', '九月', '十月', '十一月', '十二月',\r\n        '闰正月', '闰二月', '闰三月', '闰四月', '闰五月', '闰六月',\r\n        '闰七月', '闰八月', '闰九月', '闰十月', '闰十一月', '闰十二月'\r\n      ];\r\n    }\r\n    return Array.from({length: 12}, (_, i) => i + 1);\r\n  };\r\n  \r\n  \r\n\r\n  // 生成时间选项\r\n  const hours = Array.from({length: 24}, (_, i) => i.toString().padStart(2, '0'));\r\n  const minutes = Array.from({length: 60}, (_, i) => i.toString().padStart(2, '0'));\r\n  //设置省份、城市规则\r\n  const provinces = citydata.city.filter(item => item.pid === 0);\r\n  const cities = citydata.city.filter(item => item.pid !== 0);\r\n\r\n  const handleProvinceChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      province: e.target.value,\r\n      city: 'unknown'\r\n    });\r\n  };\r\n\r\n  const handleCityChange = (e) => {\r\n    setFormData({ ...formData, city: e.target.value });\r\n  };\r\n\r\n  const filteredCities = cities.filter(city => {\r\n    const selectedProvince = provinces.find(prov => prov.name === formData.province);\r\n    return selectedProvince && city.pid === selectedProvince.id;\r\n  });\r\n  \r\n\r\n// 确保在组件顶部定义了handleSubmit函数\r\nconst handleSubmit = (e) => {\r\n  e.preventDefault(); // 必须阻止默认行为\r\n  // console.log('提交数据：', formData);\r\n  \r\n  // 添加基础验证\r\n  if (!formData.year || !formData.month || !formData.day) {\r\n    alert('请选择完整的出生日期');\r\n    return;\r\n  }\r\n  if (formData.province === 'unknown' || formData.city === 'unknown') {\r\n    alert('请选择完整的地区信息');\r\n    return;\r\n  }\r\n\r\n  //性别判断\r\n  let genders\r\n  if (formData.gender === '男') { \r\n    genders = 0;\r\n  }else {\r\n      genders = 1;\r\n    }\r\n  //农历转公历\r\n  // 月份映射表\r\n  const monthMap = {\r\n    '正月': 1, '二月': 2, '三月': 3, '四月': 4, '五月': 5, '六月': 6,\r\n    '七月': 7, '八月': 8, '九月': 9, '十月': 10, '十一月': 11, '十二月': 12,\r\n    '闰正月': 1, '闰二月': 2, '闰三月': 3, '闰四月': 4, '闰五月': 5, '闰六月': 6,\r\n    '闰七月': 7, '闰八月': 8, '闰九月': 9, '闰十月': 10, '闰十一月': 11, '闰十二月': 12\r\n  };\r\n\r\n  let solarDate;\r\n  let lunarMonth = monthMap[formData.month]; \r\n  let isLeap = formData.leapMonth;\r\n  if (formData.calendarType === '农历') {\r\n    if (formData.month.startsWith('闰')) {\r\n      isLeap = true;\r\n    }\r\n    const lunarDate = window.p.Lunar2Solar(formData.year, lunarMonth, formData.day, isLeap); \r\n    solarDate = { year: lunarDate.yi, month: lunarDate.mi, day: lunarDate.dz };\r\n  } else {\r\n    solarDate =  { year: formData.year, month: lunarMonth, day: formData.day }; // 公历下直接使用月份\r\n  }\r\n  //经纬度\r\n  const selectedCity = cities.find(c => c.name === formData.city);\r\n  const J = selectedCity ? selectedCity.j : 0;\r\n  const W = selectedCity ? selectedCity.w : 0;\r\n  //八字排盘\r\n  const eightCharacters = window.p.fatemaps(\r\n    genders,\r\n    solarDate.year,\r\n    solarDate.month,\r\n    solarDate.day,\r\n    parseInt(formData.hour),\r\n    parseInt(formData.minute),\r\n    0,\r\n    J,\r\n    W\r\n  );\r\n  // console.log('八字：', eightCharacters.sz);\r\n  // console.log('八字：', eightCharacters);\r\n  // console.log('八字：', eightCharacters.sz);\r\n  \r\n  const transformUserData = (raw) => {\r\n    let txt = \"\";\r\n    // 生成八字信息\r\n    txt += \"八字：\\n\";\r\n    txt += raw.sz.join(', ') + \"\\n\";\r\n    // 生成性别信息\r\n    txt += \"性别：\" + raw.xb + \"\\n\";\r\n    // 生成大运信息\r\n    txt += \"大运：\\n\";\r\n    for (let x in raw['dy']) {\r\n      let a = raw['dy'][x];\r\n      txt += `${a['zqage']}~${a['zboz']}岁\\t${a['zfma']}${a['zfmb']}\\n`;\r\n    }\r\n    return txt; // 确保函数返回生成的文本\r\n  };\r\n  const eightCharacter = transformUserData(eightCharacters);\r\n  // console.log(eightCharacter);\r\n\r\n  onSubmit(eightCharacter); // 确保父组件传递了onSubmit\r\n};\r\n\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className={styles.formContainer}>\r\n      {/* 姓名行 */}\r\n      <div className={styles.formRow}>\r\n        <div className={styles.inputGroup}>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"请输入您的姓名（选填）\"\r\n            className={styles.underlineInput}\r\n            value={formData.name}\r\n            onChange={(e) => setFormData({...formData, name: e.target.value})}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* 性别和历法选择行 */}\r\n      <div className={styles.formRow}>\r\n        <div className={styles.buttonGroup}>\r\n          {['男', '女'].map((gender) => (\r\n            <button\r\n              key={gender}\r\n              type=\"button\"\r\n              className={`${styles.choiceButton} ${\r\n                formData.gender === gender ? styles.active : ''\r\n              }`}\r\n              onClick={() => setFormData({...formData, gender})}\r\n            >\r\n              {gender}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <div className={styles.buttonGroup}>\r\n          {['公历', '农历'].map((type) => (\r\n            <button\r\n              key={type}\r\n              type=\"button\"\r\n              className={`${styles.choiceButton} ${\r\n                formData.calendarType === type ? styles.active : ''\r\n              }`}\r\n              onClick={() => setFormData({...formData, calendarType: type})}\r\n            >\r\n              {type}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* 出生日期选择行 */}\r\n      <div className={styles.formRow1}>\r\n        <div className={styles.dateSelectGroup}>\r\n        <select \r\n            value={formData.year}\r\n            onChange={(e) => setFormData({...formData, year: e.target.value})}\r\n            className={styles.dateSelect}\r\n          >\r\n            <option value=\"\">年</option>\r\n            {years.map((year) => (\r\n              <option key={year} value={year}>{year}</option>\r\n            ))}\r\n          </select>\r\n          <select\r\n            value={formData.month}\r\n            onChange={(e) => setFormData({...formData, month: e.target.value})}\r\n            className={styles.dateSelect}\r\n          >\r\n            <option value=\"\">月</option>\r\n            {updateMonthOptions().map((month, index) => (\r\n              <option key={index} value={month}>{month}</option>\r\n            ))}\r\n          </select>\r\n          <select\r\n            value={formData.day}\r\n            onChange={(e) => setFormData({...formData, day: e.target.value})}\r\n            className={styles.dateSelect}\r\n          >\r\n            <option value=\"\">日</option>\r\n            {days.map((day) => (\r\n              <option key={day} value={day}>{day}</option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 出生时间选择 */}\r\n      <div className={styles.formRow}>\r\n        <div className={styles.timeSelectGroup}>\r\n          <select\r\n            value={formData.hour}\r\n            onChange={(e) => setFormData({...formData, hour: e.target.value})}\r\n            className={styles.dateSelect}\r\n          >\r\n            {hours.map((hour) => (\r\n              <option key={hour} value={hour}>{hour}时</option>\r\n            ))}\r\n          </select>\r\n  \r\n          <select\r\n            value={formData.minute}\r\n            onChange={(e) => setFormData({...formData, minute: e.target.value})}\r\n            className={styles.dateSelect}\r\n          >\r\n            {minutes.map((minute) => (\r\n              <option key={minute} value={minute}>{minute}分</option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      {/* 省市联动选择行 */}\r\n    \r\n\r\n      <div className={styles.formRow3}>\r\n        <select\r\n          value={formData.province}\r\n          onChange={handleProvinceChange}\r\n          className={styles.underlineInput}\r\n          style={{ marginRight: '20px' }}\r\n        >\r\n          <option value=\"unknown\">选择省份</option>\r\n          {provinces.map(province => (\r\n            <option key={province.id} value={province.name}>{province.name}</option>\r\n          ))}\r\n        </select>\r\n\r\n        <select\r\n          value={formData.city}\r\n          onChange={handleCityChange}\r\n          className={styles.underlineInput}\r\n          disabled={!formData.province || formData.province === 'unknown'}\r\n        >\r\n          <option value=\"unknown\">\r\n            {formData.province === 'unknown' ? '先选择省份' : '选择城市'}\r\n          </option>\r\n          {filteredCities.map(city => (\r\n            <option key={city.id} value={city.name}>{city.name}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n          \r\n\r\n\r\n\r\n      {/* 排盘按钮行 */}\r\n      <div className={styles.formRow}>\r\n        <button type=\"submit\" className={styles.submitButton}>\r\n          DeepSeek&Prompt 八字分析\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Form;","// src/components/PaymentModal.jsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport { QRCodeSVG } from 'qrcode.react'; \r\nimport PropTypes from 'prop-types';\r\n\r\nconst PaymentModal = ({ isOpen, qrcodeUrl, onClose }) => {\r\n  const [countdown, setCountdown] = useState(600); // 默认10分钟\r\n  // 倒计时效果\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const timer = setInterval(() => {\r\n      setCountdown(prev => Math.max(0, prev - 1));\r\n    }, 1000);\r\n\r\n    return () => clearInterval(timer);\r\n  }, [isOpen]);\r\n\r\n  // 格式化时间显示\r\n  const formatTime = (seconds) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"payment-modal\">\r\n      <div className=\"modal-content\">\r\n        <div className=\"modal-header\">\r\n          <h3>扫码支付 ¥4.99</h3>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n        \r\n        <div className=\"qrcode-wrapper\">\r\n          {qrcodeUrl ? (\r\n            <>\r\n              <QRCodeSVG \r\n                value={qrcodeUrl} \r\n                size={200}\r\n                fgColor=\"#2d3748\"\r\n                level=\"H\"\r\n              />\r\n              <p className=\"countdown\">剩余时间: {formatTime(countdown)}</p>\r\n            </>\r\n          ) : (\r\n            <div className=\"loading\">正在生成支付码...</div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"modal-footer\">\r\n          <p>请使用支付宝扫描二维码完成支付</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nPaymentModal.propTypes = {\r\n  isOpen: PropTypes.bool.isRequired,\r\n  qrcodeUrl: PropTypes.string,\r\n  onClose: PropTypes.func.isRequired\r\n};\r\n\r\nexport default PaymentModal;\r\n","import Reactmarkdown from \"react-markdown\";\r\nimport React, { useEffect, useRef } from 'react';\r\n\r\nconst ANALYSIS_TYPES = [\r\n  { id: 'health', name: '健康分析', icon: '❤️', color: '#ff7675' },\r\n  { id: 'career', name: '事业分析', icon: '💼', color: '#74b9ff' },\r\n  { id: 'wealth', name: '财运分析', icon: '💰', color: '#55efc4' },\r\n  { id: 'marriage', name: '婚姻分析', icon: '💍', color: '#a29bfe' }\r\n];\r\n\r\n// 骨架屏组件\r\nconst SkeletonLoader = () => (\r\n  <div className=\"skeleton-loader\">\r\n    <div className=\"skeleton-line\" style={{ width: '90%' }}></div>\r\n    <div className=\"skeleton-line\" style={{ width: '80%' }}></div>\r\n    <div className=\"skeleton-line\" style={{ width: '85%' }}></div>\r\n  </div>\r\n);\r\n\r\nconst AnalysisSection = ({ \r\n  preview,\r\n  unlocked,\r\n  contents,\r\n  onUnlock \r\n}) => {\r\n  const isAnyUnlocked = ANALYSIS_TYPES.some(type => unlocked[type.id]);\r\n  const cardRefs = useRef({});\r\n  const sharedUrl = typeof window !== 'undefined' ? window.location.href : '';\r\n\r\n  // 滚动到对应区块\r\n  useEffect(() => {\r\n    const lastUnlockedType = ANALYSIS_TYPES.findLast(type => unlocked[type.id]);\r\n    if (lastUnlockedType && cardRefs.current[lastUnlockedType.id]) {\r\n      cardRefs.current[lastUnlockedType.id].scrollIntoView({\r\n        behavior: 'smooth',\r\n        block: 'center'\r\n      });\r\n    }\r\n  }, [unlocked]);\r\n\r\n  // 分享功能\r\n  const handleShare = (type) => {\r\n    if (navigator.share) {\r\n      navigator.share({\r\n        title: `${type.name} - 命理分析报告`,\r\n        text: `我的${type.name}结果很有趣，快来查看你的专属命理分析！`,\r\n        url: sharedUrl\r\n      });\r\n    } else {\r\n      navigator.clipboard.writeText(sharedUrl);\r\n      alert('链接已复制到剪贴板，快去分享给好友吧！');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"analysis-container\">\r\n      {/* 预览分析部分 */}\r\n      <div className=\"preview-section\">\r\n      <h2>基础命理分析</h2>\r\n      <div className={`preview-wrapper ${isAnyUnlocked ? 'unlocked' : ''}`}>\r\n        <Reactmarkdown>{preview}</Reactmarkdown>\r\n          {!isAnyUnlocked && (\r\n            <div className=\"preview-mask\">\r\n              <div className=\"mask-content\">\r\n              <p>🔐 选择您最关心的领域解锁完整分析</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* 专项分析卡片 */}\r\n      <div className=\"analysis-grid\">\r\n        {ANALYSIS_TYPES.map(type => (\r\n          <div \r\n            key={type.id}\r\n            ref={el => cardRefs.current[type.id] = el}\r\n            className={`analysis-card ${unlocked[type.id] ? 'unlocked' : ''}`}\r\n            style={{ \r\n              borderColor: type.color,\r\n              maxHeight: unlocked[type.id] ? '1000px' : '200px'\r\n            }}\r\n          >\r\n            <div className=\"card-header\" style={{ backgroundColor: type.color }}>\r\n            <span className=\"type-icon\">{type.icon}</span>\r\n              <h3>{type.name}</h3>\r\n              {unlocked[type.id] && (\r\n                <button \r\n                  className=\"share-btn\"\r\n                  onClick={() => handleShare(type)}\r\n                  aria-label=\"分享\"\r\n                >\r\n                  ↗️\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            {unlocked[type.id] ? (\r\n              <div className=\"analysis-content\">\r\n                {contents[type.id] ? (\r\n                  <>\r\n                    <Reactmarkdown>{contents[type.id]}</Reactmarkdown>\r\n                    <button \r\n                      className=\"share-button\"\r\n                      onClick={() => handleShare(type)}\r\n                    >\r\n                      分享结果\r\n                    </button>\r\n                  </>\r\n                ) : (\r\n                  < SkeletonLoader />\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"unlock-panel\">\r\n                <button \r\n                  className=\"unlock-btn\"\r\n                  onClick={() => onUnlock(type.id)}\r\n                  style={{ backgroundColor: type.color }}\r\n                >\r\n                  解锁{type.name}（¥0.10）\r\n                </button>\r\n                <p className=\"security-tip\">🔒 支付宝扫码安全支付</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* 免责声明 */}\r\n      <div className=\"disclaimer\">\r\n        <p>※ 本分析由AI生成，仅供娱乐参考，不作为决策依据</p>\r\n        <p>※ 根据相关法规，所有数据将在24小时后自动删除</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AnalysisSection;\r\n","// const BASE_URL = process.env.NODE_ENV === 'development' \r\n//   ? 'http://localhost:5000' \r\n//   : 'https://api.yourdomain.com';\r\n\r\nconst BASE_URL ='http://8.133.207.19:5000' \r\n\r\nexport const createOrderStream = (eightCharacters, handlers) => {\r\n  const es = new EventSource(`${BASE_URL}/api/orders/stream?eightCharacters=${encodeURIComponent(eightCharacters)}`);\r\n  \r\n  es.onerror = (err) => {\r\n    handlers.onError?.(err);\r\n    es.close();\r\n  };\r\n\r\n  es.addEventListener('stream', (e) => {\r\n    const data = JSON.parse(e.data);\r\n    handlers.onStream?.(data.content);\r\n  });\r\n\r\n  es.addEventListener('stream_end', (e) => {\r\n    const data = JSON.parse(e.data);\r\n    handlers.onComplete?.(data.orderId);\r\n    es.close();\r\n  });\r\n\r\n  es.addEventListener('error', (e) => {\r\n    const data = JSON.parse(e.data);\r\n    handlers.onError?.(data.message);\r\n    es.close();\r\n  });\r\n\r\n  return es;\r\n};\r\n\r\nexport const initiatePayment = (prevOrderId, analysisType, handlers) => {\r\n  const es = new EventSource(`${BASE_URL}/api/orders/${prevOrderId}/payment?type=${analysisType}`);\r\n\r\n  es.addEventListener('payment', (e) => {\r\n    const data = JSON.parse(e.data);\r\n    handlers.onPaymentQR?.(data.qrcodeUrl, data.orderId);\r\n  });\r\n\r\n  es.addEventListener('payment_success', (e) => {\r\n    handlers.onPaymentstatus?.();\r\n  });\r\n\r\n  es.addEventListener('stream', (e) => {\r\n    const data = JSON.parse(e.data);\r\n    handlers.onAnalysisChunk?.(data.content);\r\n  });\r\n\r\n  es.addEventListener('stream_end', () => {\r\n    handlers.onAnalysisEnd?.();\r\n    es.close();\r\n  });\r\n\r\n  es.addEventListener('error', (e) => {\r\n    const data = JSON.parse(e.data);\r\n    handlers.onError?.(data.message);\r\n    es.close();\r\n  });\r\n\r\n  return es;\r\n};","import React, { useState, useEffect } from 'react';\nimport Form from './components/Form';\nimport PaymentModal from './components/PaymentModal';\nimport AnalysisSection from './components/AnalysisSection';\nimport './App.css';\nimport { createOrderStream, initiatePayment } from './api';\n\nconst ANALYSIS_TYPES = [\n  { id: 'health', name: '健康分析' },\n  { id: 'career', name: '事业分析' },\n  { id: 'wealth', name: '财运分析' },\n  { id: 'marriage', name: '婚姻分析' }\n];\n\nfunction App() {\n  const [currentOrderId, setCurrentOrderId] = useState(null);\n  const [analysisData, setAnalysisData] = useState({\n    preview: '',\n    unlocked: {},\n    contents: {\n      health: null,\n      career: null,\n      wealth: null,\n      marriage: null\n    }\n  });\n  const [paymentState, setPaymentState] = useState({\n    show: false,\n    qrcodeUrl: '',\n    processingType: null\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [es, setES] = useState(null);\n\n  const handleSubmit = async (eightCharacters) => {\n\n    setLoading(true);\n    setError('');\n    setAnalysisData({\n      preview: '',\n      unlocked: {},\n      contents: { health: '', career: '', wealth: '', marriage: '' }\n    });\n\n    const newES = createOrderStream(eightCharacters, {\n      onStream: (chunk) => {\n        setAnalysisData(prev => ({\n          ...prev,\n          preview: prev.preview + chunk\n        }));\n        setLoading(false);\n      },\n      onComplete: (prevOrderId) => {\n        setCurrentOrderId(prevOrderId ); // 模拟订单ID\n      },\n      onError: (message) => {\n        setError(message || '生成预览失败');\n        setLoading(false);\n      }\n    });\n    setES(newES);\n  };\n  const unlockAnalysis = (type) => {\n    if (!currentOrderId) return;\n    console.log(\"选择分析\",type)\n    setPaymentState({\n      show: true,\n      qrcodeUrl: '',\n      processingType: type\n    });\n\n    const paymentES = initiatePayment(currentOrderId, type, {\n      onPaymentQR: (qrcodeUrl, orderId) => {\n        setPaymentState(prev => ({ ...prev, qrcodeUrl }));\n        // setCurrentOrderId(orderId);\n      },\n      onAnalysisChunk: (chunk) => {\n        setAnalysisData(prev => ({\n          ...prev,\n          contents: {\n            ...prev.contents,\n            [type]: (prev.contents[type] || '') + chunk\n          }\n        }));\n      },\n\n      onPaymentstatus: () => {\n        setAnalysisData(prev => ({\n          ...prev,\n          unlocked: { ...prev.unlocked, [type]: true }\n        }));\n        setPaymentState({ show: false, qrcodeUrl: '', processingType: null });\n      },\n\n      onAnalysisEnd: () => {\n        // setAnalysisData(prev => ({\n        //   ...prev,\n        //   unlocked: { ...prev.unlocked, [type]: true }\n        // }));\n        // setPaymentState({ show: false, qrcodeUrl: '', processingType: null });\n      },\n\n      onError: (message) => {\n        setError(message || '支付流程出错');\n        setPaymentState({ show: false, qrcodeUrl: '', processingType: null });\n      }\n    });\n\n    setES(paymentES);\n  };\n\n  useEffect(() => {\n    return () => es?.close();\n  }, [es]);\n\n\n  return (\n    <div className=\"App\">\n      <header className=\"header\">\n        <div className=\"header-content\">\n          <div className=\"branding\">\n            <h1>LiMing命理</h1>\n            <p className=\"slogan\">一阴一阳之谓道</p>\n          </div>\n          <div className=\"logo-container\">\n            <img src=\"/logo.png\" alt=\"Logo\" className=\"logo\" />\n          </div>\n        </div>\n      </header>\n\n      \n        {error && <div className=\"error-message\">{error}</div>}\n        \n        {loading ? (\n            <div className=\"loading-wrapper\">\n            <div className=\"loading\">\n              ⏳ 深度分析通常需要 1~2 分钟\n              <div className=\"sub-hint\">（期间请不要刷新页面）</div>\n            </div>\n          </div>\n        ) : (\n          !analysisData.preview ? (\n            <Form onSubmit={handleSubmit} />\n          ) : (\n            <AnalysisSection \n              preview={analysisData.preview}\n              unlocked={analysisData.unlocked}\n              contents={analysisData.contents}\n              onUnlock={unlockAnalysis}\n              analysisTypes={ANALYSIS_TYPES}\n            />\n          )\n        )}\n\n        <PaymentModal\n          isOpen={paymentState.show}\n          qrcodeUrl={paymentState?.qrcodeUrl}\n          onClose={() => setPaymentState({ show: false, qrcode: '', processingType: null })}\n        />\n    \n\n      <footer>\n        <div className=\"sfooterContent\">\n          <p className=\"sdisclaimer\">\n            拒绝向未成年人提供服务，仅供娱乐和参考。\n          </p>\n          <p className=\"sdisclaimer\">\n          ©2025 LiMing命理\n          </p>\n        </div>\n      </footer>\n\n    </div>\n    \n  );\n}\n\nexport default App;\n\n\n\n\n// const [analysis, setAnalysis] = useState({\n//   preview: '',\n//   full: '',\n//   orderId: null,\n//   qrcodeUrl: '',\n//   paid: false\n// });\n// const [showPayment, setShowPayment] = useState(false);\n// const [loading, setLoading] = useState(false);\n// const [error, setError] = useState(null);\n\n\n// const handleSubmit = async (eightCharacters) => {\n//   try {\n//     setLoading(true);\n//     setError(null);\n//     console.log('前端数据：', eightCharacters);\n//     // 创建订单并获取支付信息\n//     const eventSource = api.createOrderStream(eightCharacters);\n//     eventSource.onopen = () => {\n//       console.log('SSE连接已建立');\n//       setLoading(true);\n//     };\n\n\n//   eventSource.addEventListener('analysis', (e) => {\n//     const data = JSON.parse(e.data);\n//     // if (!data.content) return;\n//     setAnalysis(prev => ({\n//       ...prev,\n//       preview: prev.preview + data.content\n//     }));\n//     setLoading(false);\n//   });\n\n//   // 接收支付信息\n//   eventSource.addEventListener('payment', (e) => {\n//     const data = JSON.parse(e.data);\n//     setAnalysis(prev => ({\n//       ...prev,\n//       orderId: data.orderId,\n//       qrcodeUrl: data.qrcodeUrl,\n//       // 保留当前预览内容\n//       preview: prev.preview || '' \n//     }));\n//     setShowPayment(false);\n//   });\n\n//   // 处理正常结束\n//   eventSource.addEventListener('end', () => {\n//     console.log('SSE连接正常关闭');\n//     eventSource.close();\n//     setLoading(false);\n//   });\n\n//   // 错误处理\n//   eventSource.onerror = (err) => {\n//     console.error('SSE连接错误:', err);\n//     setError('连接异常，请刷新重试');\n//     eventSource.close();\n//     setLoading(false);\n//   };\n\n//   // 组件卸载时关闭连接\n//   return () => {\n//     if (eventSource) {\n//       eventSource.close();\n//     }\n//   };\n\n// } catch (err) {\n//   setError(err.message || '提交失败，请重试');\n//   setLoading(false);\n// }\n// };\n\n\n// // 支付状态轮询\n// useEffect(() => {\n//   if (!analysis?.orderId || analysis.paid) return;\n\n//   const interval = setInterval(async () => {\n//     try {\n//       const { data: status } = await api.checkOrderStatus(analysis.orderId);\n//       console.log(\"付款判断：\", status.paid)\n//       //修改！！\n//       if (status.paid) {\n//         console.log(\"支付判断\")\n//         const { data: Analysis } = await api.getFullAnalysis(analysis.orderId);\n//         const pendingContent = Analysis\n//         .join('')                  // 合并所有字符串\n//         .replace(/null/g, '')      // 删除所有null字面量\n//         .trim();\n//         const fullAnalysis =analysis.preview + pendingContent;\n//         setAnalysis(prev => ({\n//           ...prev,\n//           full: fullAnalysis,\n//           paid: true\n//         }));\n//         console.log(\"全结果：\", fullAnalysis)\n//         clearInterval(interval);\n//       }\n//     } catch (err) {\n//       console.error('支付状态检查失败:', err);\n//     }\n//   }, 3000);\n\n//   return () => clearInterval(interval);\n// }, [analysis]);\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}